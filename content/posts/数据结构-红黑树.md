+++
title = "数据结构 红黑树"
description = "description"
keywords = ["key1", "key2"]
categories = ["category"]
tags = ["tag"]
date = 2019-07-08T15:58:25+08:00
draft = true
# CJKLanguage: Chinese, Japanese, Korean
isCJKLanguage = true
# 排序你的文章
weight = 40

# 这里还可以自定义任何参数，这些参数可以在模板中使用
toc = true
comments = false
# 精选图片
featured_image = ""
+++

> 数据结构：红黑树  
<!--more-->
### 概念
#### 红黑树的性质
- 性质一：节点是红色或黑色。
- 性质二：根是黑色。
- 性质三：所有叶子都是黑色（叶子是NIL节点）。
- 性质四：每个红色节点必须有两个黑色的子节点。（从每个叶子到根的所有路径上不能有两个连续的红色节点。）
- 性质五：从任一节点到其每个叶子的所有简单路径都包含相同数目的黑色节点（简称黑高）。

### 操作
---
#### 插入操作
这里假设要插入的节点为 N，N 的父节点为 P，祖父节点为 G，叔叔节点为 U。插入红色节点后，会出现5种情况，分别如下：

- 情况一：插入的节点N的为根节点，则直接把颜色改成黑色即可。
- 情况二：N 的父节点是黑色，这种情况下，性质4（每个红色节点必须有两个黑色的子节点）和性质5没有受到影响，不需要调整。
- 情况三：N 的节点的祖父节点为null，即插入的节点的父节点是根节点，直接插入即可（因为根节点肯定是黑色）
- 情况四：插入的节点父节点和祖父节点都存在，并且其父节点是祖父节点的左节点，分两种子情况：
    - i 插入节点的叔叔节点是红色，则将父亲节点和叔叔节点都改成黑色，然后祖父节点改成红色即可。
    - ii 插入节点的叔叔节点是黑色或不存在：
        - a.若插入节点是其父节点的右孩子，则将其父节点左旋，
        - b.若为左孩子，则将其父节点变成黑色节点，将其祖父节点变成红色节点，然后将其祖父节点右旋。
- 情况五：插入的节点父节点和祖父节点都存在，并且其父节点是祖父节点的右节点。这种情况跟上面是类似的，分两种情况：
    - i 插入节点的叔叔节点是红色，则将父亲节点和叔叔节点都改成黑色，然后祖父节点改成红色即可。
    - ii 插入节点的叔叔节点是黑色或不存在：
        - a.若插入节点是其父节点的左孩子，则将其父节点右旋
        - b.若为右孩子，则将其父节点变成黑色节点，将其祖父节点变成红色节点，然后将其祖父节点左旋。

[![红黑树插入总结.jpg](https://i.postimg.cc/tg7cYPnF/3-4-5.jpg)](https://postimg.cc/rdXjHDJp)

假设插入的顺序为：10，5，9，3，6，7，19，32，24，17

- 先来插个10，为情况一，直接改成黑色即可
- 再插入5，为情况二，比10小，放到10的左孩子位置
- 插入9，比10小，但是比5大，放到5的右孩子位置,此时是情况四，左旋后变成情况五，然后再右旋变色
[![1.png](https://i.postimg.cc/Pqk4kwzt/1.png)](https://postimg.cc/rDQW1zPb)
- 插入3后，变成情况三，将父节点和叔叔节点同时变色即可
- 插入6后，根据情况2不需要调整
- 插入7后，变为情况三，将父节点和叔叔节点同时变色即可
[![2.png](https://i.postimg.cc/ryYNwbCZ/2.png)](https://postimg.cc/ThgDktsn)
- 插入19，为情况二，不需要调整
- 插入32，为情况四，左旋、变色
[![3.png](https://i.postimg.cc/TPqc23Cn/3.png)](https://postimg.cc/4KycBsC3)
- 插入24，右旋，变色
[![4.png](https://i.postimg.cc/Fs8pDqYk/4.png)](https://postimg.cc/w75DBwc9)
- 插入17
[![5.png](https://i.postimg.cc/jSfX9Xfg/5.png)](https://postimg.cc/w16LRD0L)

#### 删除操作
##### 二叉搜索树的删除
- 待删除的节点无左右孩子
直接删除即可
- 待删除的节点只有左孩子或者右孩子
直接把该节点的父节点指向它的左孩子或者右孩子即可
- 待删除的节点既有左孩子又有右孩子
需要先找到其右子树的最左孩子（或者左子树的最右孩子），即左（右）子树中序遍历时的第一个节点，然后将其与待删除的节点互换，最后再删除该节点（如果有右子树，则右子树上位）。总之，就是先找到它的替代者，找到之后替换这个要删除的节点，然后再把这个节点真正删除掉。

##### 红黑树的删除调整
删除完之后，如果替代者是红色节点，则不需要调整，如果是黑色节点，则会导致左子树和右子树路径中黑色节点数量不一致，需要进行红黑树的调整
- 只有右孩子且为红色，直接用右孩子替换该节点然后变成黑色即可。
- 只有右孩子且为黑色，那么删除该节点会导致父节点的左子树路径上黑色节点减一，此时只能去借助右子树，从右子树中借一个红色节点过来即可，具体取决于右子树的情况，这里又分成两种：
    - i.兄弟节点是红色，则此时父节点是黑色，且兄弟节点肯定有两个孩子，且兄弟节点的左右子树路径上均有两个黑色节点，此时只需将兄弟节点与父节点颜色互换，然后将父节点左旋，左旋后，兄弟节点的左子树SL挂到了父节点p的右孩子位置，这时会导致p的右子树路径上的黑色节点比左子树多一，此时再SL置为红色即可。
    - ii.兄弟节点是黑色，那么就只能打它孩子的主意了，这里主要关注远侄子（兄弟节点的右孩子，即SR）的颜色情况，这里分成两种情况：
        - a.远侄子SR是黑色，近侄子任意（白色代表颜色可为任意颜色），则先将S转为红色，然后右旋，再将SL换成P节点颜色，P涂成黑色，S也涂成黑色，再进行左旋即可。其实简单说就是SL上位，替换父节点位置。
        - b.远侄子SR为红色，近侄子任意（该子树路径中有且仅有一个黑色节点），则先将兄弟节点与父节点颜色互换，将SR涂成黑色，再将父节点左旋即可。

### 相关文档
---
- [Day25 史上最详细的HashMap红黑树解析](https://www.cnblogs.com/mfrank/p/9227097.html)
- [红黑树详细分析，看了都说好](https://segmentfault.com/a/1190000012728513?utm_source=tag-newest)

